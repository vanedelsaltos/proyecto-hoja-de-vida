{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Hoja de Vida - {{ perfil.nombre_completo }}</title>
    <style>
        @page { size: A4; margin: 0; }
        body { 
            font-family: 'Helvetica', Arial, sans-serif; 
            color: #333; line-height: 1.4; margin: 0; padding: 0; font-size: 11pt;
        }

        /* Contenedor Principal */
        .cv-container { display: flex; width: 100%; min-height: 297mm; }

        /* Lateral Izquierdo (Sidebar) */
        .sidebar { width: 35%; background-color: #a3867a; color: white; padding: 30px 20px; }
        .foto-container { text-align: center; margin-bottom: 25px; }
        .foto-perfil { width: 140px; height: 140px; border-radius: 50%; border: 4px solid white; object-fit: cover; }
        
        /* T√≠tulos del Sidebar estilo imagen */
        .sidebar-header { 
            background-color: #eee9e6; color: #a3867a; padding: 6px 15px; 
            font-weight: bold; font-size: 1.1em; margin-top: 20px; border-radius: 2px;
            text-transform: uppercase;
        }
        .info-list { list-style: none; padding: 0; margin: 10px 0; }
        .info-list li { margin-bottom: 10px; font-size: 0.9em; }
        .info-list li strong { display: block; color: #fff; margin-bottom: 2px; }

        /* Contacto con c√≠rculos blancos */
        .contact-row { display: flex; align-items: center; margin: 15px 0; }
        .icon-circle { 
            width: 32px; height: 32px; background: white; border-radius: 50%; 
            color: #a3867a; display: flex; align-items: center; justify-content: center; 
            margin-right: 12px; flex-shrink: 0; font-size: 16px;
        }

        /* Columna Derecha */
        .main-content { width: 65%; padding: 40px 30px; background: white; }
        .header-box { background-color: #f8f1ee; padding: 25px; margin-bottom: 20px; }
        h1 { font-size: 2.2em; margin: 0; color: #222; border-bottom: 4px solid #a3867a; display: inline-block; }
        .perfil-sub { font-weight: bold; font-size: 1.3em; color: #333; margin-top: 15px; }

        /* Timeline y Secciones */
        .main-title { border-bottom: 2px solid #a3867a; color: #222; font-size: 1.2em; margin-top: 30px; padding-bottom: 5px; text-transform: uppercase; }
        .timeline-item { border-left: 2px solid #a3867a; padding-left: 20px; margin-left: 10px; margin-bottom: 20px; position: relative; }
        .timeline-item::before { content: ""; position: absolute; left: -7px; top: 0; width: 12px; height: 12px; background: #a3867a; border-radius: 50%; }
        
        .puesto { font-weight: bold; font-size: 1.1em; color: #a3867a; margin: 0; }
        .empresa-info { font-weight: bold; color: #555; margin: 2px 0; font-size: 0.95em; }
        .periodo { font-size: 0.85em; color: #777; font-style: italic; }

        /* Productos */
        .producto-card { display: flex; gap: 15px; background: #fdfdfd; padding: 15px; border: 1px solid #eee; margin-top: 15px; page-break-inside: avoid; }
        .producto-img { width: 140px; height: auto; border-radius: 4px; }
    </style>
</head>
<body>

<div class="cv-container">
    <aside class="sidebar">
        <div class="foto-container">
            {% if perfil.foto_perfil %}<img src="{{ perfil.foto_perfil.url }}" class="foto-perfil">{% endif %}
        </div>

        <div class="sidebar-header">Informaci√≥n Personal</div>
        <ul class="info-list">
            <li><strong>Nombres y Apellidos:</strong> {{ perfil.nombres }} {{ perfil.apellidos }}</li>
            <li><strong>Nacionalidad:</strong> {{ perfil.nacionalidad }}</li>
            <li><strong>Nacimiento:</strong> {{ perfil.fechanacimiento }}</li>
            <li><strong>Lugar:</strong> {{ perfil.lugarnacimiento }}</li>
            <li><strong>Sexo:</strong> {{ perfil.get_sexo_display }}</li>
            <li><strong>Estado civil:</strong> {{ perfil.estadocivil }}</li>
        </ul>

        <div class="sidebar-header">Contacto</div>
        <div class="contact-row">
            <div class="icon-circle">üì±</div>
            <div class="contact-text"><strong>Tel√©fono:</strong><br>M√≥vil: {{ perfil.telefonoconvencional }}<br>Fijo: {{ perfil.telefonofijo }}</div>
        </div>
        {% if perfil.sitioweb %}
        <div class="contact-row">
            <div class="icon-circle">üåê</div>
            <div class="contact-text"><strong>Web:</strong><br>{{ perfil.sitioweb }}</div>
        </div>
        {% endif %}
        <div class="contact-row">
            <div class="icon-circle">üÜî</div>
            <div class="contact-text"><strong>C√©dula:</strong><br>{{ perfil.numerocedula }}</div>
        </div>

        <div class="sidebar-header">Direcci√≥n</div>
        <div class="contact-row">
            <div class="icon-circle">üè†</div>
            <div class="contact-text"><strong>Domicilio:</strong><br>{{ perfil.direcciondomiciliaria }}</div>
        </div>
        {% if perfil.direcciontrabajo %}
        <div class="contact-row">
            <div class="icon-circle">üè¢</div>
            <div class="contact-text"><strong>Trabajo:</strong><br>{{ perfil.direcciontrabajo }}</div>
        </div>
        {% endif %}

        {% if perfil.licenciaconducir %}
        <div class="sidebar-header">Licencias</div>
        <div class="contact-row">
            <div class="icon-circle">üöó</div>
            <div class="contact-text"><strong>Licencia:</strong><br>{{ perfil.licenciaconducir }}</div>
        </div>
        {% endif %}
    </aside>

    <main class="main-content">
        <div class="header-box">
            <h1>{{ perfil.nombre_completo|upper }}</h1>
            <div class="perfil-sub">Perfil Profesional</div>
            <p style="margin-top: 10px;">{{ perfil.descripcionperfil }}</p>
        </div>

        {% if experiencias %}
        <h2 class="main-title">Experiencia Laboral</h2>
        {% for exp in experiencias %}
        <div class="timeline-item">
            <p class="puesto">{{ exp.cargo_desempenado }}</p>
            <p class="empresa-info">{{ exp.nombre_empresa }} | {{ exp.lugar_empresa }}</p>
            <p class="periodo">Periodo: {{ exp.fecha_inicio_gestion }} - {% if exp.fecha_fin_gestion %}{{ exp.fecha_fin_gestion }}{% else %}Actualidad{% endif %}</p>
            {% if exp.descripcion_funciones %}<p style="font-size:0.9em; margin-top:5px;">{{ exp.descripcion_funciones }}</p>{% endif %}
        </div>
        {% endfor %}
        {% endif %}

        {% if cursos %}
        <h2 class="main-title">Cursos Realizados</h2>
        {% for curso in cursos %}
        <div class="timeline-item">
            <p class="puesto">{{ curso.nombrecurso }}</p>
            <p class="empresa-info">{{ curso.entidadpatrocinadora }} ({{ curso.totalhoras }}h)</p>
            <p class="periodo">{{ curso.fechainicio }} - {{ curso.fechafin }}</p>
        </div>
        {% endfor %}
        {% endif %}

        {% if reconocimientos %}
        <h2 class="main-title">Reconocimientos</h2>
        {% for rec in reconocimientos %}
        <div class="timeline-item">
            <p class="puesto">{{ rec.tiporeconocimiento }}</p>
            <p class="empresa-info">{{ rec.entidadpatrocinadora }}</p>
            <p class="periodo">{{ rec.fechareconocimiento }}</p>
            <p style="font-size:0.9em;">{{ rec.descripcionreconocimiento }}</p>
        </div>
        {% endfor %}
        {% endif %}
    </main>
</div>

<div style="padding: 20px 40px;">
    {% if productos_academicos %}
    <h2 class="main-title">Productos Acad√©micos</h2>
    {% for prod in productos_academicos %}
    <div class="producto-card">
        <div style="flex:2;">
            <h3 style="margin:0; color:#a3867a;">{{ prod.nombrerecurso }}</h3>
            <p style="font-size:0.85em; color:#666;"><strong>Tipo:</strong> {{ prod.clasificador }}</p>
            <p>{{ prod.descripcion }}</p>
        </div>
        {% if prod.imagen %}<img src="{{ prod.imagen.url }}" class="producto-img">{% endif %}
    </div>
    {% endfor %}
    {% endif %}

    {% if productos_laborales %}
    <h2 class="main-title">Productos Laborales</h2>
    {% for prod in productos_laborales %}
    <div class="producto-card">
        <div style="flex:2;">
            <h3 style="margin:0; color:#a3867a;">{{ prod.nombreproducto }}</h3>
            <p style="font-size:0.85em; color:#666;"><strong>Tipo:</strong> {{ prod.tipoproducto }} | <strong>Fecha:</strong> {{ prod.fecha_producto }}</p>
            <p>{{ prod.descripcion }}</p>
        </div>
        {% if prod.imagen %}<img src="{{ prod.imagen.url }}" class="producto-img">{% endif %}
    </div>
    {% endfor %}
    {% endif %}
</div>

<!-- ===================== PORTADA CERTIFICADOS ===================== -->
<div style="page-break-before: always; text-align:center; font-size:42px; font-weight:bold; margin-top:120mm;">
    CERTIFICADOS
</div>



<!-- ===================== CERTIFICADOS ===================== -->
{% for exp in certificados_experiencias %}
    {% if exp.imagen_certificado %}
    <div style="page-break-before: always; padding:15mm;">
        <img src="{{ exp.imagen_certificado.url }}" style="width:100%;height:100%;object-fit:contain;">
    </div>
    {% endif %}
{% endfor %}

{% for rec in certificados_reconocimientos %}
    {% if rec.imagen_certificado %}
    <div style="page-break-before: always; padding:15mm;">
        <img src="{{ rec.imagen_certificado.url }}" style="width:100%;height:100%;object-fit:contain;">
    </div>
    {% endif %}
{% endfor %}

{% for curso in certificados_cursos %}
    {% if curso.imagen_certificado %}
    <div style="page-break-before: always; padding:15mm;">
        <img src="{{ curso.imagen_certificado.url }}" style="width:100%;height:100%;object-fit:contain;">
    </div>
    {% endif %}
{% endfor %}



</body>
</html>
