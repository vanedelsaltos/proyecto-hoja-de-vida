{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Hoja de Vida - {{ perfil.nombre_completo }}</title>

    <!-- BASE para que WeasyPrint resuelva im谩genes y CSS -->
    <base href="{{ css_url|cut:'css/hoja_de_vida.css' }}">

    <!-- CSS PRINCIPAL (ruta absoluta enviada desde views.py) -->
    <link rel="stylesheet" href="{{ css_url }}">

    <!-- Fuente (WeasyPrint no descarga Google Fonts, se deja como fallback) -->
    <style>
        body {
            font-family: 'Roboto', Arial, Helvetica, sans-serif;
        }
    </style>
</head>
<body>


<!-- ===================== CV PRINCIPAL ===================== -->
<div class="cv-container">


    <!-- ========== COLUMNA IZQUIERDA ========== -->
    <aside class="sidebar">

        <!-- Foto de perfil -->
        <div class="foto-container">
            {% if perfil.foto_perfil %}
                <img src="{{ perfil.foto_perfil.url }}" class="foto-perfil">
            {% endif %}
        </div>

        {% if perfil %}

        <!-- Informaci贸n Personal -->
        <section class="sidebar-section">
            <h2 class="sidebar-title">Informaci贸n Personal</h2>
            <ul class="info-personal-bullets">
            {% if perfil.nombres or perfil.apellidos %}
                <li>
                    <strong>Nombres y Apellidos:</strong><br>{{ perfil.nombres }} {{ perfil.apellidos }}
                </li>
            {% endif %}
            {% if perfil.nacionalidad %}
                <li>
                    <strong>Nacionalidad:</strong><br>{{ perfil.nacionalidad }}
                </li>
            {% endif %}
            {% if perfil.fechanacimiento %}
                <li>
                    <strong>Fecha de nacimiento:</strong><br>{{ perfil.fechanacimiento }}
                </li>
            {% endif %}
            {% if perfil.lugarnacimiento %}
                <li>
                    <strong>Lugar de nacimiento:</strong><br>{{ perfil.lugarnacimiento }}
                </li>
            {% endif %}
            {% if perfil.sexo %}
                <li>
                    <strong>Sexo:</strong><br>{{ perfil.get_sexo_display }}
                </li>
            {% endif %}
            {% if perfil.estadocivil %}
                <li>
                    <strong>Estado civil:</strong><br>{{ perfil.estadocivil }}
                </li>
            {% endif %}
            </ul>
        </section>

        <!-- Contacto -->
        <section class="sidebar-section">
            <h2 class="sidebar-title">Contacto</h2>
            <ul class="info-personal">
                {% if perfil.telefonoconvencional or perfil.telefonofijo %}
                <li class="contact-item">
                    <div class="icon-circle"></div>
                    <span>
                        <strong>Tel茅fono:</strong><br>
                        {% if perfil.telefonoconvencional %}M贸vil: {{ perfil.telefonoconvencional }}<br>{% endif %}
                        {% if perfil.telefonofijo %}Fijo: {{ perfil.telefonofijo }}{% endif %}
                    </span>
                </li>
                {% endif %}

                {% if perfil.sitioweb %}
                <li class="contact-item">
                    <div class="icon-circle"></div>
                    <span><strong>Sitio web:</strong><br>{{ perfil.sitioweb }}</span>
                </li>
                {% endif %}

                {% if perfil.numerocedula %}
                <li class="contact-item">
                    <div class="icon-circle"></div>
                    <span><strong>C茅dula:</strong><br>{{ perfil.numerocedula }}</span>
                </li>
                {% endif %}

                {% if perfil.email %}
                <li class="contact-item">
                    <div class="icon-circle">锔</div>
                    <span><strong>Email:</strong><br>{{ perfil.email }}</span>
                </li>
                {% endif %}
            </ul>
        </section>

        <!-- Direcci贸n -->
        <section class="sidebar-section">
            <h2 class="sidebar-title">Direcci贸n</h2>
            <ul class="info-personal">
                {% if perfil.direcciondomiciliaria %}
                <li class="contact-item">
                    <div class="icon-circle"></div>
                    <span><strong>Domicilio:</strong><br>{{ perfil.direcciondomiciliaria }}</span>
                </li>
                {% endif %}
                {% if perfil.direcciontrabajo %}
                <li class="contact-item">
                    <div class="icon-circle"></div>
                    <span><strong>Trabajo:</strong><br>{{ perfil.direcciontrabajo }}</span>
                </li>
                {% endif %}
            </ul>
        </section>

        <!-- Licencias -->
        <section class="sidebar-section">
            <h2 class="sidebar-title">Licencias y Permisos</h2>
            <ul class="info-personal">
                {% if perfil.licenciaconducir %}
                <li class="contact-item">
                    <div class="icon-circle"></div>
                    <span><strong>Licencia:</strong><br>{{ perfil.licenciaconducir }}</span>
                </li>
                {% endif %}
            </ul>
        </section>

        {% endif %}
    </aside>


    <!-- ========== COLUMNA DERECHA ========== -->
    <main class="main-content">

        {% if perfil %}
        <header class="header-right">
            <h1>{{ perfil.nombre_completo|upper }}</h1>
            {% if perfil.descripcionperfil %}
            <div class="bio">
                <h2>Perfil Profesional</h2>
                <p>{{ perfil.descripcionperfil }}</p>
            </div>
            {% endif %}
        </header>
        {% endif %}

        {{ block.super }}

    </main>
</div>


<!-- ===================== CERTIFICADOS ===================== -->
<div style="page-break-before: always; text-align:center; font-size:42px; font-weight:bold; margin-top:120mm;">
    CERTIFICADOS
</div>

{% for exp in certificados_experiencias %}
{% if exp.imagen_certificado %}
<div style="page-break-before: always; padding:15mm;">
    <img src="{{ exp.imagen_certificado.url }}" style="width:100%;height:100%;object-fit:contain;">
</div>
{% endif %}
{% endfor %}

{% for rec in certificados_reconocimientos %}
{% if rec.imagen_certificado %}
<div style="page-break-before: always; padding:15mm;">
    <img src="{{ rec.imagen_certificado.url }}" style="width:100%;height:100%;object-fit:contain;">
</div>
{% endif %}
{% endfor %}

{% for curso in certificados_cursos %}
{% if curso.imagen_certificado %}
<div style="page-break-before: always; padding:15mm;">
    <img src="{{ curso.imagen_certificado.url }}" style="width:100%;height:100%;object-fit:contain;">
</div>
{% endif %}
{% endfor %}

</body>
</html>
