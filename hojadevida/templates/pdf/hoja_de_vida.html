{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Hoja de Vida - {{ perfil.nombre_completo }}</title>
    <style>
        @page { size: A4; margin: 0; }
        body { 
            font-family: 'Helvetica', Arial, sans-serif; 
            color: #333; line-height: 1.4; margin: 0; padding: 0; font-size: 11pt;
            background-color: white;
        }

        .cv-container { 
            display: flex; 
            width: 100%; 
            min-height: 297mm; /* Mantiene el fondo caf√© hasta el final de la hoja */
        }

        /* Sidebar */
        .sidebar { 
            width: 35%; 
            background-color: #a3867a; 
            color: white; 
            padding: 30px 20px;
            box-sizing: border-box;
        }
        .foto-perfil { width: 140px; height: 140px; border-radius: 50%; border: 4px solid white; object-fit: cover; display: block; margin: 0 auto 25px; }
        
        .sidebar-header { 
            background-color: #eee9e6; color: #a3867a; padding: 6px 15px; 
            font-weight: bold; font-size: 1.1em; margin-top: 20px; border-radius: 2px;
            text-transform: uppercase;
        }
        .info-list { list-style: none; padding: 0; margin: 10px 0; font-size: 0.9em; }
        .contact-row { display: flex; align-items: center; margin: 15px 0; page-break-inside: avoid; }
        .icon-circle { 
            width: 30px; height: 30px; background: white; border-radius: 50%; 
            color: #a3867a; display: flex; align-items: center; justify-content: center; 
            margin-right: 12px; flex-shrink: 0;
        }

        /* Contenido Principal */
        .main-content { 
            width: 65%; padding: 40px 30px; background: white; box-sizing: border-box;
        }
        .header-box { background-color: #f8f1ee; padding: 25px; margin-bottom: 20px; }
        h1 { font-size: 2.2em; margin: 0; color: #222; border-bottom: 4px solid #a3867a; display: inline-block; }

        .main-title { 
            border-bottom: 2px solid #a3867a; color: #222; font-size: 1.2em; 
            margin-top: 25px; padding-bottom: 5px; text-transform: uppercase;
            page-break-after: avoid;
        }
        .section-block { page-break-inside: avoid; margin-bottom: 20px; }
        
        .timeline-item { 
            border-left: 2px solid #a3867a; padding-left: 20px; 
            margin-left: 10px; margin-bottom: 15px; position: relative; 
        }
        .timeline-item::before { 
            content: ""; position: absolute; left: -7px; top: 0; 
            width: 12px; height: 12px; background: #a3867a; border-radius: 50%; 
        }
        
        .full-width-section { width: 100%; padding: 20px 40px; box-sizing: border-box; }
        .producto-card { 
            display: flex; gap: 15px; background: #fdfdfd; padding: 15px; 
            border: 1px solid #eee; margin-top: 15px; page-break-inside: avoid;
        }
    </style>
</head>
<body>

<div class="cv-container">
    <aside class="sidebar">
        {% if perfil.foto_perfil %}<img src="{{ perfil.foto_perfil.url }}" class="foto-perfil">{% endif %}

        <div class="sidebar-header">Informaci√≥n Personal</div>
        <ul class="info-list">
            <li><strong>Nombres:</strong> {{ perfil.nombres }} {{ perfil.apellidos }}</li>
            <li><strong>Nacionalidad:</strong> {{ perfil.nacionalidad }}</li>
            <li><strong>Nacimiento:</strong> {{ perfil.fechanacimiento }}</li>
            <li><strong>Estado civil:</strong> {{ perfil.estadocivil }}</li>
        </ul>

        <div class="sidebar-header">Contacto</div>
        <div class="contact-row">
            <div class="icon-circle">üì±</div>
            <div class="contact-text"><strong>Tel√©fono:</strong><br>{{ perfil.telefonoconvencional }}</div>
        </div>

        <div class="sidebar-header">Direcci√≥n</div>
        <div class="contact-row">
            <div class="icon-circle">üè†</div>
            <div class="contact-text"><strong>Domicilio:</strong><br>{{ perfil.direcciondomiciliaria }}</div>
        </div>

        {% if perfil.licenciaconducir %}
        <div class="sidebar-header">Licencias</div>
        <div class="contact-row">
            <div class="icon-circle">üöó</div>
            <div class="contact-text"><strong>Licencia:</strong><br>{{ perfil.licenciaconducir }}</div>
        </div>
        {% endif %}
    </aside>

    <main class="main-content">
        <div class="header-box">
            <h1>{{ perfil.nombre_completo|upper }}</h1>
            <p style="margin-top:10px;"><strong>Perfil Profesional:</strong><br>{{ perfil.descripcionperfil }}</p>
        </div>

        <div class="section-block">
            <h2 class="main-title">Experiencia Laboral</h2>
            {% for exp in experiencias %}
            <div class="timeline-item">
                <p><strong>{{ exp.cargo_desempenado }}</strong></p>
                <p>{{ exp.nombre_empresa }} | {{ exp.fecha_inicio_gestion }} - {{ exp.fecha_fin_gestion|default:"Actualidad" }}</p>
            </div>
            {% endfor %}
        </div>

        <div class="section-block">
            <h2 class="main-title">Cursos Realizados</h2>
            {% for curso in cursos %}
            <div class="timeline-item">
                <p><strong>{{ curso.nombrecurso }}</strong></p>
                <p>{{ curso.entidadpatrocinadora }} ({{ curso.total_horas }}h)</p>
            </div>
            {% endfor %}
        </div>

        {% if reconocimientos %}
        <div class="section-block">
            <h2 class="main-title">Reconocimientos</h2>
            {% for rec in reconocimientos %}
            <div class="timeline-item">
                <p><strong>{{ rec.tiporeconocimiento }}</strong></p>
                <p>{{ rec.entidadpatrocinadora }} | {{ rec.fechareconocimiento }}</p>
                <p style="font-size: 0.9em;">{{ rec.descripcionreconocimiento }}</p>
            </div>
            {% endfor %}
        </div>
        {% endif %}
    </main>
</div>

<div class="full-width-section">
    {% if productos_academicos %}
    <h2 class="main-title">Productos Acad√©micos</h2>
    {% for prod in productos_academicos %}
    <div class="producto-card">
        <div style="flex:2;">
            <h3 style="margin:0; color:#a3867a;">{{ prod.nombrerecurso }}</h3>
            <p>{{ prod.descripcion }}</p>
        </div>
        {% if prod.imagen %}<img src="{{ prod.imagen.url }}" style="width:120px; border-radius:4px;">{% endif %}
    </div>
    {% endfor %}
    {% endif %}
    

    {% if productos_laborales %}
    <h2 class="main-title">Productos Laborales</h2>
    {% for prod in productos_laborales %}
    <div class="producto-card">
        <div style="flex:2;">
            <h3 style="margin:0; color:#a3867a;">{{ prod.nombreproducto }}</h3>
            <p style="font-size:0.85em; color:#666;"><strong>Tipo:</strong> {{ prod.tipoproducto }} | <strong>Fecha:</strong> {{ prod.fecha_producto }}</p>
            <p>{{ prod.descripcion }}</p>
        </div>
        {% if prod.imagen %}<img src="{{ prod.imagen.url }}" class="producto-img">{% endif %}
    </div>
    {% endfor %}
    {% endif %}
    </div>
</div>

<!-- ===================== PORTADA CERTIFICADOS ===================== -->
<div style="page-break-before: always; text-align:center; font-size:42px; font-weight:bold; margin-top:120mm;">
    CERTIFICADOS
</div>



<!-- ===================== CERTIFICADOS ===================== -->
{% for exp in certificados_experiencias %}
    {% if exp.imagen_certificado %}
    <div style="page-break-before: always; padding:15mm;">
        <img src="{{ exp.imagen_certificado.url }}" style="width:100%;height:100%;object-fit:contain;">
    </div>
    {% endif %}
{% endfor %}

{% for rec in certificados_reconocimientos %}
    {% if rec.imagen_certificado %}
    <div style="page-break-before: always; padding:15mm;">
        <img src="{{ rec.imagen_certificado.url }}" style="width:100%;height:100%;object-fit:contain;">
    </div>
    {% endif %}
{% endfor %}

{% for curso in certificados_cursos %}
    {% if curso.imagen_certificado %}
    <div style="page-break-before: always; padding:15mm;">
        <img src="{{ curso.imagen_certificado.url }}" style="width:100%;height:100%;object-fit:contain;">
    </div>
    {% endif %}
{% endfor %}



</body>
</html>
